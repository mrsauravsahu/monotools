{
  "tests": [
    {
      "name": "monorepo: one-service-changed",
      "repoSetup": [
        "git checkout -b main",
        "mkdir -p apps/service1/src",
        "cp ../../../../.gitversion.yml apps/service1",
        "git commit -am 'initial commit' --allow-empty",
        "git tag -a 'v0.1.0' -m 'v0.1.0'",
        "git checkout -b develop",
        "git checkout -b feat/my-feature",
        "echo \"console.log('hello world')\" > apps/service1/src/main.js",
        "git add apps; git commit -m 'one commit' --allow-empty"
      ],
      "inputs": {
        "env": {
          "GITVERSION_REPO_TYPE": "MONOREPO",
          "GITHUB_HEAD_REF": "feat/my-feature",
          "GITHUB_BASE_REF": "develop",
          "SEMVERYEASY_CHANGED_SERVICES": "apps/service1",
          "GITVERSION_CONFIG_MONOREPO": "apps/$svc/.gitversion.yml"
        },
        "existingPullRequestDescription": "adding new feature"
      },
      "expectedOutputs": {
        "changes": "diff_source=develop\ndiff_dest=feat/my-feature\nchanged=''\nchanged_services=''\nchanged_services=\"apps/service1\"\n",
        "pullRequestDescription": "PR_BODY=\"## impact surface\\\\n- apps/service1 - v0.2.0-alpha.1\\\\n\"\n",
        "updatedPullRequestDescription": "PR_BODY=\"adding new feature\\\\n## impact surface\\\\n- apps/service1 - v0.2.0-alpha.1\\\\n\"\n"
      }
    },
    {
      "name": "monorepo: update-pr-description",
      "repoSetup": [
        "git checkout -b main",
        "mkdir -p apps/semver-yeasy/src",
        "cp ../../../../.gitversion.yml apps/semver-yeasy",
        "git commit -am 'initial commit' --allow-empty",
        "git tag -a 'v0.1.0' -m 'v0.1.0'",
        "git checkout -b develop",
        "git checkout -b feat/my-feature",
        "echo \"console.log('hello world')\" > apps/semver-yeasy/src/main.js",
        "git add apps; git commit -m 'one commit' --allow-empty"
      ],
      "inputs": {
        "env": {
          "GITVERSION_REPO_TYPE": "MONOREPO",
          "GITHUB_HEAD_REF": "feat/my-feature",
          "GITHUB_BASE_REF": "develop",
          "SEMVERYEASY_CHANGED_SERVICES": "apps/semver-yeasy",
          "GITVERSION_CONFIG_MONOREPO": "apps/$svc/.gitversion.yml"
        },
        "existingPullRequestDescription": "adding new feature \n\n[comment]: # (START semver-yeasy) \n## impact surface\n- apps/test - v0.2.0-intermediate.commit.tag.1 \n\n[comment]: # (END semver-yeasy)"
      },
      "expectedOutputs": {
        "changes": "diff_source=develop\ndiff_dest=feat/my-feature\nchanged=''\nchanged_services=''\nchanged_services=\"apps/semver-yeasy\"\n",
        "pullRequestDescription": "PR_BODY=\"## impact surface\\\\n- apps/semver-yeasy - v0.2.0-alpha.1\\\\n\"\n",
        "updatedPullRequestDescription": "PR_BODY=\"adding new feature \\n\\n[comment]: # (START semver-yeasy) \\n## impact surface\\n- apps/semver-yeasy - v0.2.0-alpha.1 \\n\\n[comment]: # (END semver-yeasy)\""
      }
    }
  ]
}